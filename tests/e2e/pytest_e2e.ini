[tool:pytest]
# E2E Test Configuration for AI Teddy Bear
minversion = 6.0
addopts = 
    -v
    --tb=short
    --strict-markers
    --disable-warnings
    --asyncio-mode=auto
    --cov=src
    --cov-report=html:htmlcov
    --cov-report=xml:coverage.xml
    --cov-report=term-missing
    --cov-fail-under=80
    --durations=10
    --maxfail=5

testpaths = 
    tests/e2e

python_files = 
    test_*.py

python_classes = 
    Test*

python_functions = 
    test_*

markers =
    e2e: End-to-end tests
    child_safety: Child safety and COPPA compliance tests
    production_api: Production API flow tests
    security: Security testing
    performance: Performance testing
    error_handling: Error handling and edge case tests
    slow: Slow running tests (>30s)
    integration: Integration tests
    unit: Unit tests
    smoke: Smoke tests for quick validation
    regression: Regression tests
    load: Load testing
    chaos: Chaos engineering tests

# Test discovery
collect_ignore = [
    "setup.py",
    "conftest.py"
]

# Asyncio configuration
asyncio_mode = auto

# Coverage configuration
[coverage:run]
source = src
omit = 
    */tests/*
    */venv/*
    */migrations/*
    */__pycache__/*
    */site-packages/*

[coverage:report]
exclude_lines =
    pragma: no cover
    def __repr__
    raise AssertionError
    raise NotImplementedError
    if __name__ == .__main__.:
    class .*\bProtocol\):
    @(abc\.)?abstractmethod

show_missing = True
precision = 2

[coverage:html]
directory = htmlcov