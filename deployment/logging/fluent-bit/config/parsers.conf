# ðŸ§¸ AI TEDDY BEAR V5 - FLUENT BIT PARSERS
# ========================================
# Log parsing configurations for different log formats

[PARSER]
    Name         json
    Format       json
    Time_Key     timestamp
    Time_Format  %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep    On
    # Decode_Field_As escaped_utf8 log do_next
    # Decode_Field_As escaped      log

[PARSER]
    Name         docker
    Format       json
    Time_Key     time
    Time_Format  %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep    On

[PARSER]
    Name         apache
    Format       regex
    Regex        ^(?<host>[^ ]*) [^ ]* (?<user>[^ ]*) \[(?<time>[^\]]*)\] "(?<method>\S+)(?: +(?<path>[^\"]*?)(?: +\S*)?)?" (?<code>[^ ]*) (?<size>[^ ]*)(?: "(?<referer>[^\"]*)" "(?<agent>[^\"]*)")?$
    Time_Key     time
    Time_Format  %d/%b/%Y:%H:%M:%S %z

[PARSER]
    Name         nginx
    Format       regex
    Regex        ^(?<remote>[^ ]*) (?<host>[^ ]*) (?<user>[^ ]*) \[(?<time>[^\]]*)\] "(?<method>\S+)(?: +(?<path>[^\"]*)? +\S*)?" (?<code>[^ ]*) (?<size>[^ ]*)(?: "(?<referer>[^\"]*)" "(?<agent>[^\"]*)")? "(?<x_forwarded_for>[^\"]*)"?
    Time_Key     time
    Time_Format  %d/%b/%Y:%H:%M:%S %z

[PARSER]
    Name         syslog
    Format       regex
    Regex        ^\<(?<pri>[0-9]+)\>(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<message>.*)$
    Time_Key     time
    Time_Format  %b %d %H:%M:%S

[PARSER]
    Name         fastapi
    Format       regex
    Regex        ^(?<time>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2},\d{3}) - (?<name>[^ ]*) - (?<level>[^ ]*) - (?<message>.*)$
    Time_Key     time
    Time_Format  %Y-%m-%d %H:%M:%S,%L

[PARSER]
    Name         python-json
    Format       json
    Time_Key     timestamp
    Time_Format  %Y-%m-%dT%H:%M:%S.%f%z
    Time_Keep    On

[PARSER]
    Name         child-safety-log
    Format       json
    Time_Key     timestamp
    Time_Format  %Y-%m-%dT%H:%M:%S.%f%z
    Time_Keep    On
    # Special handling for child safety logs

[PARSER]
    Name         security-log
    Format       json
    Time_Key     timestamp
    Time_Format  %Y-%m-%dT%H:%M:%S.%f%z
    Time_Keep    On
    # Special handling for security logs

[PARSER]
    Name         audit-log
    Format       json
    Time_Key     timestamp
    Time_Format  %Y-%m-%dT%H:%M:%S.%f%z
    Time_Keep    On
    # Special handling for audit logs with extended retention

[PARSER]
    Name         multiline-json
    Format       regex
    Regex        ^(?<time>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.*) (?<level>\w+) (?<message>.*)
    Time_Key     time
    Time_Format  %Y-%m-%dT%H:%M:%S.%f%z

[MULTILINE_PARSER]
    name          python-traceback
    type          regex
    flush_timeout 1000
    #
    # rules |   state name  | regex pattern                  | next state
    # ------|---------------|--------------------------------------------
    rule      "start_state"   "/^(?<time>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2},\d{3}) - (?<name>\S+) - (?<level>\S+) - (?<message>.*)/"  "cont"
    rule      "cont"          "/^[\s]+/"                     "cont"

[MULTILINE_PARSER]
    name          multiline-json
    type          regex
    flush_timeout 1000
    #
    # rules |   state name  | regex pattern                  | next state
    # ------|---------------|--------------------------------------------
    rule      "start_state"   "/^{.*/"                       "json_cont"
    rule      "json_cont"     "/^[\s\t]+.*/"                 "json_cont"